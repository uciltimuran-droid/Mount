-- G-M V1 DELTA ANDROID 100% WORKING
-- Paste → EXECUTE → SEE PANEL IN 2 SEC

local plr = game.Players.LocalPlayer
local core = game:GetService("CoreGui")  -- <<< THIS LINE FIXES EVERYTHING

-- CREATE GUI IN CORE GUI (DELTA CAN'T HIDE IT)
local gui = Instance.new("ScreenGui")
gui.Name = "GMV1"
gui.ResetOnSpawn = false
gui.Parent = core   -- <<< DELTA-PROOF

-- NOTIFICATION SO YOU KNOW IT LOADED
game.StarterGui:SetCore("SendNotification", {
    Title = "G-M V1";
    Text = "Loaded! Drag from top";
    Duration = 5;
})

-- MAIN PANEL
local main = Instance.new("Frame")
main.Size = UDim2.new(0, 300, 0, 400)
main.Position = UDim2.new(0.5, -150, -0.5, 0)  -- start above screen
main.BackgroundColor3 = Color3.fromRGB(15,15,30)
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true
main.Parent = gui

local corner = Instance.new("UICorner", main)
corner.CornerRadius = UDim.new(0, 16)
local stroke = Instance.new("UIStroke", main)
stroke.Color = Color3.fromRGB(0,180,255)
stroke.Thickness = 3

-- TITLE
local title = Instance.new("TextLabel")
title.Text = "G-M V1"
title.Size = UDim2.new(1,0,0,50)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.GothamBold
title.TextSize = 26
title.Parent = main

-- MINIMIZE
local min = Instance.new("TextButton")
min.Text = "—"
min.Size = UDim2.new(0,50,0,50)
min.Position = UDim2.new(1,-55,0,0)
min.BackgroundColor3 = Color3.fromRGB(80,80,100)
min.TextColor3 = Color3.new(1,1,1)
min.Font = Enum.Font.GothamBold
min.TextSize = 30
min.Parent = main
local mc = Instance.new("UICorner", min); mc.CornerRadius = UDim.new(0,12)

local content = Instance.new("Frame")
content.Size = UDim2.new(1,0,1,-50)
content.Position = UDim2.new(0,0,0,50)
content.BackgroundTransparency = 1
content.Parent = main

local minimized = false
min.MouseButton1Click:Connect(function()
    minimized = not minimized
    content.Visible = not minimized
    min.Text = minimized and "+" or "—"
    main.Size = minimized and UDim2.new(0,300,0,50) or UDim2.new(0,300,0,400)
end)

-- FLY BUTTON
local flyBtn = Instance.new("TextButton")
flyBtn.Text = "FLY OFF"
flyBtn.Size = UDim2.new(0.9,0,0,50)
flyBtn.Position = UDim2.new(0.05,0,0,10)
flyBtn.BackgroundColor3 = Color3.fromRGB(120,30,30)
flyBtn.TextColor3 = Color3.new(1,1,1)
flyBtn.Font = Enum.Font.GothamBold
flyBtn.TextSize = 22
flyBtn.Parent = content
local fc = Instance.new("UICorner", flyBtn); fc.CornerRadius = UDim.new(0,12)

-- SPEED BOX
local speed = Instance.new("TextBox")
speed.PlaceholderText = "Speed (50)"
speed.Text = "50"
speed.Size = UDim2.new(0.9,0,0,40)
speed.Position = UDim2.new(0.05,0,0,70)
speed.BackgroundColor3 = Color3.fromRGB(60,60,80)
speed.TextColor3 = Color3.new(1,1,1)
speed.Parent = content
local sc = Instance.new("UICorner", speed); sc.CornerRadius = UDim.new(0,10)

-- TELEPORT LIST
local list = Instance.new("ScrollingFrame")
list.Size = UDim2.new(0.9,0,0,220)
list.Position = UDim2.new(0.05,0,0,130)
list.BackgroundColor3 = Color3.fromRGB(40,40,60)
list.ScrollBarThickness = 8
list.Parent = content
local lc = Instance.new("UICorner", list); lc.CornerRadius = UDim.new(0,12)
local layout = Instance.new("UIListLayout", list)
layout.Padding = UDim.new(0,5)

-- FLY LOGIC
local flying = false
local bv, bg
local keys = {}

local function startFly()
    local root = plr.Character.HumanoidRootPart
    local hum = plr.Character.Humanoid
    bv = Instance.new("BodyVelocity", root)
    bv.MaxForce = Vector3.new(1e5,1e5,1e5)
    bg = Instance.new("BodyGyro", root)
    bg.MaxTorque = Vector3.new(1e5,1e5,1e5)
    bg.P = 5000
    hum.PlatformStand = true
    flying = true
    flyBtn.Text = "FLY ON"
    flyBtn.BackgroundColor3 = Color3.fromRGB(30,120,30)

    game:GetService("RunService").Heartbeat:Connect(function()
        if not flying then return end
        local cam = workspace.CurrentCamera
        local dir = Vector3.new(
            (keys.D and 1 or 0) - (keys.A and 1 or 0),
            (keys.Space and 1 or 0) - (keys.LeftControl and 1 or 0),
            (keys.S and 1 or 0) - (keys.W and 1 or 0)
        )
        if dir.Magnitude > 0 then
            bv.Velocity = cam.CFrame:VectorToWorldSpace(dir) * tonumber(speed.Text) or 50
        else
            bv.Velocity = Vector3.new()
        end
        bg.CFrame = cam.CFrame
    end)
end

local function stopFly()
    flying = false
    if bv then bv:Destroy() end
    if bg then bg:Destroy() end
    plr.Character.Humanoid.PlatformStand = false
    flyBtn.Text = "FLY OFF"
    flyBtn.BackgroundColor3 = Color3.fromRGB(120,30,30)
end

flyBtn.MouseButton1Click:Connect(function()
    if flying then stopFly() else startFly() end
end)

-- KEYS
game:GetService("UserInputService").InputBegan:Connect(function(i)
    if i.KeyCode == Enum.KeyCode.W then keys.W = true
    elseif i.KeyCode == Enum.KeyCode.A then keys.A = true
    elseif i.KeyCode == Enum.KeyCode.S then keys.S = true
    elseif i.KeyCode == Enum.KeyCode.D then keys.D = true
    elseif i.KeyCode == Enum.KeyCode.Space then keys.Space = true
    elseif i.KeyCode == Enum.KeyCode.LeftControl then keys.LeftControl = true
    end
end)

game:GetService("UserInputService").InputEnded:Connect(function(i)
    local k = i.KeyCode
    if k == Enum.KeyCode.W then keys.W = false
    elseif k == Enum.KeyCode.A then keys.A = false
    elseif k == Enum.KeyCode.S then keys.S = false
    elseif k == Enum.KeyCode.D then keys.D = false
    elseif k == Enum.KeyCode.Space then keys.Space = false
    elseif k == Enum.KeyCode.LeftControl then keys.LeftControl = false
    end
end)

-- TELEPORT LIST
local function refresh()
    list:ClearAllChildren()
    for _, p in pairs(game.Players:GetPlayers()) do
        if p ~= plr then
            local b = Instance.new("TextButton")
            b.Size = UDim2.new(1,0,0,40)
            b.BackgroundColor3 = Color3.fromRGB(70,70,90)
            b.Text = p.DisplayName
            b.TextColor3 = Color3.new(1,1,1)
            b.Font = Enum.Font.Gotham
            b.Parent = list
            local bc = Instance.new("UICorner", b); bc.CornerRadius = UDim.new(0,10)
            b.MouseButton1Click:Connect(function()
                plr.Character.HumanoidRootPart.CFrame = p.Character.HumanoidRootPart.CFrame + Vector3.new(0,5,5)
            end)
        end
    end
    list.CanvasSize = UDim2.new(0,0,0,layout.AbsoluteContentSize.Y + 10)
end
refresh()
game.Players.PlayerAdded:Connect(refresh)
game.Players.PlayerRemoving:Connect(refresh)

-- ANIMATION
game:GetService("TweenService"):Create(main, TweenInfo.new(0.7, Enum.EasingStyle.Back), {
    Position = UDim2.new(0.5,-150,0.5,-200)
}):Play()

-- RESPAWN FIX
plr.CharacterAdded:Connect(function() task.wait(1); stopFly() end)
